<cite>
**本文档中引用的文件**
- [Cargo.toml](file://Cargo.toml)
- [src/lib.rs](file://src/lib.rs)
</cite>

## 目录
1. [简介](#简介)
2. [开发环境搭建](#开发环境搭建)
3. [功能开发与缺陷修复](#功能开发与缺陷修复)
4. [Cargo Features 扩展机制](#cargo-features-扩展机制)
5. [代码提交规范](#代码提交规范)
6. [沟通与协作](#沟通与协作)

## 简介
本贡献指南旨在为开发者提供参与 `phytium-pi-uart` 项目开发的清晰指引。该项目是一个为 Phytium Pi 平台设计的 UART 串行通信驱动，采用 Rust 语言编写，并遵循 `no_std` 嵌入式开发原则。本指南将详细介绍从环境配置到代码提交的完整流程。

**Section sources**
- [Cargo.toml](file://Cargo.toml#L1-L22)
- [src/lib.rs](file://src/lib.rs#L1-L3)

## 开发环境搭建
为了参与本项目的开发，您需要配置一个支持交叉编译的 Rust 工具链。由于这是一个嵌入式 `no_std` 项目，标准库不可用，因此必须使用适当的 target 配置。

首先，确保已安装最新版本的 Rust 工具链（`rustup`）。然后，根据目标硬件平台添加相应的编译目标。虽然具体的 target 名称未在现有文件中明确指出，但基于项目性质，您可能需要添加如 `riscv64gc-unknown-none-elf` 或类似的嵌入式目标。

依赖管理通过 Cargo 进行，核心依赖包括 `tock-registers` 用于寄存器操作、`log` 用于日志记录以及 `spin` 提供无堆栈的同步原语。请确保您的开发环境能够正确解析这些依赖项。

**Section sources**
- [Cargo.toml](file://Cargo.toml#L10-L18)
- [src/lib.rs](file://src/lib.rs#L1)

## 功能开发与缺陷修复
当您需要添加新功能或修复 bug 时，请遵循以下步骤：

1.  **理解需求**：仔细分析要实现的功能或要修复的问题。
2.  **编写代码**：在 `src/lib.rs` 中实现您的更改。目前该文件仅包含基本的模块声明和 TODO 注释，所有功能均需在此基础上开发。
3.  **处理 unsafe 代码**：如果您的实现涉及直接内存访问或调用外部接口等操作，可能会使用 `unsafe` 块。**任何 `unsafe` 代码都必须经过严格的安全审查**。在提交 PR 时，务必详细说明 `unsafe` 代码的合理性、其安全边界以及为何无法用安全的 Rust 代码替代。

**Section sources**
- [src/lib.rs](file://src/lib.rs#L1-L4)

## Cargo Features 扩展机制
本项目通过 Cargo 的 features 机制来条件性地编译代码，以支持不同的功能变体。当前 `Cargo.toml` 文件中定义了一个空的 `default` feature。

您可以利用此机制来扩展功能，例如启用中断模式。具体做法是在 `[features]` 部分添加新的 feature，如 `interrupt-mode`，并将其关联到特定的依赖或条件编译代码块。在源码中，可以使用 `#[cfg(feature = "interrupt-mode")]` 宏来包裹相关实现，从而实现功能的按需开启。

**Section sources**
- [Cargo.toml](file://Cargo.toml#L20-L21)

## 代码提交规范
在向项目提交 Pull Request (PR) 时，请遵守以下规范：

- **文档更新**：如果您的更改影响了公共 API 或引入了新功能，必须相应地更新文档。这包括在 `src/lib.rs` 中添加或修改模块级、函数级的文档注释（doc comments）。
- **代码注释**：对于复杂的逻辑或算法，应添加清晰的内联注释，解释其工作原理。特别是 `unsafe` 代码块，必须附有详尽的注释说明其安全保证。
- **测试**：尽管当前代码库中尚未发现测试文件，但强烈建议为新功能编写单元测试或集成测试，以确保代码的可靠性。

**Section sources**
- [src/lib.rs](file://src/lib.rs#L2)
- [Cargo.toml](file://Cargo.toml#L7)

## 沟通与协作
项目的作者信息已在 `Cargo.toml` 中列出，为“Phytium Pi Driver Team”。项目的官方仓库位于 [https://github.com/arceos-org/phytium-pi-uart](https://github.com/arceos-org/phytium-pi-uart)，这是报告问题、讨论功能和提交 PR 的主要场所。

由于项目根目录下缺少 `README.md` 文件，建议在首次贡献时，优先补充一份详细的 `README`，其中应包含项目介绍、快速开始指南和本贡献指南的链接，以便于后续开发者。

**Section sources**
- [Cargo.toml](file://Cargo.toml#L4-L6)